<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mvp.mapper.AskBoardMapper">
	
	<!-- 게시글 등록 -->
	<insert id="enroll">
		insert into askBoard(title, content, writer) values=(#{title}, #{content}, #{writer})
	</insert>
	
	<!-- 게시글 조회 -->
	<select id="select" resultType="com.mvp.model.AskBoardVO">
		SELECT * 
		FROM askBoard
		WHERE ano = #{ano}
	</select>
	
	<!-- 게시판 목록 -->
	<select id="getList" resultType="com.mvp.model.AskBoardVO">
		select * from askBoard
	</select>
	
	<!-- 게시글 목록 조회 -->
	<select id="selectList" resultType="com.mvp.model.AskBoardVO">
		<![CDATA[
		SELECT * FROM(
			SELECT /*+INDEX_DESC(askBoard SYS_C008540)*/ ROWNUM AS rn, ano, userId, title, content, answerCk,regDate, updateDate, viewCnt FROM askBoard
			WHERE   
	      ]]>         
            <if test="keyword != null">
                title LIKE '%'||#{keyword}||'%' AND
            </if>
            
	      <![CDATA[        
	             rownum <= #{pageNum} * #{amount}
	            )
	        where rn > (#{pageNum} - 1) * #{amount}
	      ]]>
	</select>
	
	<!-- 게시글 개수 -->
	<select id="boardGetTotal" resultType="int">
		SELECT COUNT(*) FROM askBoard
		<if test="keyword !=null">
			WHERE title LIKE '%'|| #{keyword} || '%' 
		</if>
	</select>
	
	<!-- 관리자 답변 달기 -->
	<update id="addAnswer">
		UPDATE askBoard SET 
			ANSWERCK='O', 
			ANSWER = #{answer}, 
			ANSWERDATE = sysdate
		where ano = #{ano}
	</update>
	
	<!-- 관리자 답변 삭제 -->
	<update id="deleteAnswer">
		UPDATE askBoard SET 
			ANSWERCK='X', 
			ANSWER = null, 
			ANSWERDATE = null
		where ano = #{ano}
	</update>


</mapper>